{% extends 'admin/base.html.twig' %}

{% block title %} Historique {% endblock %}


{% block body %}

<div class="pcoded-content">
	<div class="pcoded-inner-content">
		<div class="main-body">
			<div class="page-wrapper">
				<div class="page-body">
					{% for label, messages in app.flashes %}
						<div class="alert alert-{{ label }} background-{{ label }}">
							<button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<i class="icofont icofont-close-line-circled text-white"></i>
							</button>
							{% for message in messages %}
								<p style="margin-bottom: 0px !important;">{{ message | raw }}</p>
							{% endfor %}
						</div>
					{% endfor %}
					<div class="card">
						<div class="card-header">
							<h5>Historique des modifications</h5>
							<a href="{{ path('admin_order_filter_histories') }}" class="btn btn-out-dashed waves-effect waves-light btn-primary btn-square text-right" style="float: right; padding: 5px 10px; margin: 0px 5px;">Filtrer l'historique</a>
						</div>
						<div class="card-block table-border-style">
							{% if histories %}
								<div class="table-responsive">
									<table class="table table-striped table-bordered datatable display">
										<thead>
											<tr>
												<th>Commande</th>
												<th>Date</th>
												<th>Utilisateur</th>
												<th>Modification</th>
											</tr>
										</thead>
										<tbody>
											{% for history in histories %}
												<tr>
													<td>
                            {% if history.invoice %}
                							<a href="{{ path('admin_order_edit', { id: history.invoice.id }) }}" style="color: #007bff;" target="_blank">
                            	N°{{ history.invoice.id }}
                            	</a>
                            {% endif %}
                          </td>
													<td>{{history.createdAt|date_fr('dd MMMM yyyy')|title }} à
														{{history.createdAt|date('H') }}h{{history.createdAt|date('i') }}</td>
													<td>{{ history.admin.firstname|capitalize }}</td>
													<td>
														{% if "Le montant payé" in history.title %}
															<span style="color:#2ed8b6; font-weight: bold;">{{ history.title }}</span>
														{% else %}
														{{ history.title }}
														{% endif %}
													</td>
												</tr>
											{% endfor %}
										</tbody>
									</table>
								</div>
							{% else %}
								Il n'y a pas de modifications.
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		</div>
		<div id="styleSelector"></div>
	</div>
</div>
</div>
</div>


{% endblock %}


{% block javascripts %}

{% include 'admin/partials/datatable.html.twig' %}
{% endblock %}
